

CC = @CC@

RM = @RM@ -f -v


INSTALL = @INSTALL@


BINARY = fakenes@EXEEXT@

DATAFILE = support/fakenes.dat


IFLAGS = -Iinclude -Isupport `allegro-config --cflags`

DFLAGS = @DFLAGS@ -DPOSIX


CFLAGS = ${IFLAGS} @CFLAGS@ ${DFLAGS}


LIBRARIES = `allegro-config --libs` @LIBRARIES@


OBJECTS = apu.o audio.o core.o cpu.o gui.o input.o papu.o ppu.o rom.o \
    main.o mmc.o netplay.o video.o support/unzip.o


all : bootstrap ${BINARY}


bootstrap :

	@echo Please wait while FakeNES builds...


${BINARY} : ${OBJECTS}

	${CC} ${OBJECTS} -o ${BINARY} ${LIBRARIES}


install : ${BINARY} ${DATAFILE}

	@echo Installing the FakeNES binary and datafile...

	${INSTALL} -m 0755 ${BINARY} /usr/bin

	${INSTALL} -m 0644 ${DATAFILE} /usr/share


	@echo Run \'${BINARY}\' once to create the configuration file.

	@echo It will be stored in \'$HOME/.fakenes\'.


uninstall :

	@echo Removing FakeNES from your system...

	@echo User specific generated files will NOT be removed.


	${RM} /usr/bin/${BINARY}

	${RM} /usr/share/${DATAFILE}


.SUFFIXES : .c

%.o : %.c

	${CC} -c $< -o $@ ${CFLAGS}


include build/common.mk


clean :

	${RM} ${OBJECTS}

	${RM} ${BINARY}


distclean :

	${RM} Makefile
