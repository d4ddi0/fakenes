

CC = @CC@

MKDIR = mkdir -p

RM = rm -f -v


INSTALL = @INSTALL@


SUPPORT = support


BINARY = fakenes@EXEEXT@

DATAFILE = fakenes.dat


IFLAGS = -Iinclude `allegro-config --cflags`

DFLAGS = @DFLAGS@ -DPOSIX


CFLAGS = ${IFLAGS} @CFLAGS@ ${DFLAGS}


LIBRARIES = `allegro-config --libs` @LIBS@


OBJECTS = apu.o audio.o core.o cpu.o gui.o input.o papu.o ppu.o \
          rom.o main.o mmc.o video.o


all : bootstrap ${BINARY}


bootstrap :

	@echo Please wait while FakeNES builds...


${BINARY} : ${OBJECTS}

	${CC} ${OBJECTS} -o ${BINARY} ${LIBRARIES}


install : ${BINARY} ${SUPPORT}/${DATAFILE}

	@echo Creating directory \'${HOME}/.fakenes\'...

	${MKDIR} ${HOME}/.fakenes


	@echo Installing the FakeNES binaries...

	${INSTALL} -m 0755 ${BINARY} /usr/bin

	${INSTALL} -m 0644 ${SUPPORT}/${DATAFILE} ${HOME}/.fakenes


	@echo Run \'${BINARY}\' once to create the configuration file.

	@echo It will be stored in \'${HOME}/.fakenes\'.


uninstall :

	@echo Removing FakeNES from your system...

	@echo \(Configuration and SRAM files will NOT be removed.\)


	${RM} /usr/bin/${BINARY}

	${RM} ${HOME}/.fakenes/${DATAFILE}


uninstallall :

	@echo Removing FakeNES from your system...

	@echo Configuration and SRAM files will be lost!


	${RM} /usr/bin/${BINARY}

	${RM} -r ${HOME}/.fakenes


.SUFFIXES : .c

%.o : %.c

	${CC} -c $< -o $@ ${CFLAGS}


include build/common.mk


clean :

	${RM} ${OBJECTS}

	${RM} ${BINARY}


distclean :

	${RM} Makefile
