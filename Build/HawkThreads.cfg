# Threading is not supported under DOS for now.
ifplat msdos uninvoke 0

do ifplat unix
	# HawkThreads requires Pthreads on Unix.
	do ifnot "${HAVE_PTHREADS}"='true'
		if "${QUIET_BOOTSTRAP}"='false' echo 'Boostrap: (Warning) Pthreads missing, skipping HawkThreads.'
		uninvoke 0
	done
done

# Source code paths.
HAWKTHREADS_PATH = "${FRAMEWORK_PATH}HawkThreads${PATH_SEPARATOR}"
HAWKTHREADS_PATH_SRC = "${HAWKTHREADS_PATH}src${PATH_SEPARATOR}"
HAWKTHREADS_PATH_INCLUDE = "${HAWKTHREADS_PATH}include${PATH_SEPARATOR}"

# Compile path.
COMPILE_PATH_HAWKTHREADS = "${COMPILE_PATH_FRAMEWORKS}HawkThreads${PATH_SEPARATOR}"
COMPILE_PATH_HAWKTHREADS_SRC = "${COMPILE_PATH_HAWKTHREADS}src${PATH_SEPARATOR}"

do ifnopt clean
	ifnexist "${COMPILE_PATH_HAWKTHREADS}"		@mkdir "${COMPILE_PATH_HAWKTHREADS}"
	ifnexist "${COMPILE_PATH_HAWKTHREADS_SRC}"	@mkdir "${COMPILE_PATH_HAWKTHREADS_SRC}"
done

CLEAN_DIRECTORIES += " ${COMPILE_PATH_HAWKTHREADS_SRC}"
CLEAN_DIRECTORIES += " ${COMPILE_PATH_HAWKTHREADS}"

# Source files.
SOURCE_FILES += " ${HAWKTHREADS_PATH_SRC}htcondition.c"
SOURCE_FILES += " ${HAWKTHREADS_PATH_SRC}hthread.c"
SOURCE_FILES += " ${HAWKTHREADS_PATH_SRC}htmutex.c"

# Preprocessor flags.
CPPFLAGS += " -DUSE_HAWKTHREADS -I${HAWKTHREADS_PATH_SRC} -I${HAWKTHREADS_PATH_INCLUDE}"
